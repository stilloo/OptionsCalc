#{extends 'main.html' /}
#{set title:'Options Strategy Builder' /}

  <!-- Le styles -->
    <link href="@{'/public/stylesheets/bootstrap.css'}" rel="stylesheet">
   
    <link href="@{'/public/stylesheets/bootstrap-responsive.css'}" rel="stylesheet">

 <style type="text/css">
  .throbber {
    background: url("data:image/gif;base64,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") no-repeat scroll center center gray;
    height: 100%;
    opacity: 0.2;
    position: absolute;
    width: 100%;
}
 
 </style>
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="../assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="@{'/public/images/apple-touch-icon-114-precomposed.png'}">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="@{'/public/images/apple-touch-icon-72-precomposed.png'}">
    <link rel="apple-touch-icon-precomposed" href="@{'/public/images/apple-touch-icon-57-precomposed.png'}">
   <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="#">Options Earnings</a>
            <ul class="nav">
              <li class="active"><a href="/">Home</a></li>
               <li class="dropdown">
       			 <a class="dropdown-toggle" data-toggle="dropdown" href="#">Software <b class="caret"></b></a>
      			 <ul class="dropdown-menu">
          			<li><a href="/application/optionscalc">Strategy Builder</a></li>
         			<li><a href="/application/history">Historic Viewer</a></li>
       			 </ul>
      		</li>
      		  <li><a href="#education">Education</a></li>
              <li><a href="#contact">Contact Us</a></li>
              <li><a href="#about">About</a></li>
            </ul>
        </div>
      </div>
    </div>
    	<script  type="text/javascript" src="@{'/public/javascripts/jquery-1.7.1.js'}"></script>
	<script src="@{'/public/javascripts/jquery.ui.core.js'}"></script>
	<script src="@{'/public/javascripts/jquery.ui.widget.js'}"></script>
	<script src="@{'/public/javascripts/jquery.ui.datepicker.js'}"></script>
	
	
		
	<script>
	$(function() {
		 $("#ticker").keyup(function(event){
			    if(event.keyCode == 13){
			        $("#gobutton").click();
			    }
			});
		
	});
	
	</script>
	<script type="text/javascript">
	
	// YQL serves JSONP (with a callback) so all we have to do
	// is create a script element with the right 'src':
	function YQLQuery(query, callback) {
	    this.query = query;
	    this.callback = callback || function(){};
	    this.fetch = function() {
	 
	        if (!this.query || !this.callback) {
	            throw new Error('YQLQuery.fetch(): Parameters may be undefined');
	        }
	 
	        var scriptEl = document.createElement('script'),
	            uid = 'yql' + +new Date(),
	            encodedQuery = encodeURIComponent(this.query.toLowerCase()),
	            instance = this;
	 
	        YQLQuery[uid] = function(json) {
	            instance.callback(json);
	            delete YQLQuery[uid];
	            document.body.removeChild(scriptEl);
	        };
	 
	        scriptEl.src = 'http://query.yahooapis.com/v1/public/yql?q='
	                     + encodedQuery + '&format=json&callback=YQLQuery.' + uid + "&env=" + escape("store://datatables.org/alltableswithkeys"); 
	        document.body.appendChild(scriptEl);
	 
	    };
	}
	
	function queryYQL()
	{
		//Construct your query:
			 var optionsquery = "SELECT * FROM yahoo.finance.options WHERE symbol='"+document.getElementById('ticker').value+"' AND expiration in (SELECT contract FROM yahoo.finance.option_contracts WHERE symbol='"+document.getElementById('ticker').value+"')";
		  	var stockquery = "select * from yahoo.finance.quotes where symbol='"+document.getElementById('ticker').value+"'";
			// Define your callback:
			var callback = function(data) {
				var quote = data.query.results.quote.Ask;
				if(quote == null || quote == '')
				{
					quote = data.query.results.quote.AskRealtime;
				
					if(quote == null || quote == 0.00 || quote == '' || quote == 0)
						{
						quote = data.query.results.quote.LastTradePriceOnly;
						}
				}
				document.getElementById('stockPrice').value = quote;
				Change_Cursor('none');
			};
			 
			// Instantiate with the query:
			var ajaxianPosts = new YQLQuery(stockquery, callback);
			 
			// If you're ready then go:
			ajaxianPosts.fetch(); // Go!!
	}
	
	
	function queryYQL1()
	{
		//Construct your query:
			 var optionsquery = "SELECT contract FROM yahoo.finance.option_contracts WHERE symbol='"+document.getElementById('ticker').value+"'";
			// Define your callback:
			var callback = function(data) {
				 var combo = document.getElementById("expiration_1");
				 combo.options.length = 0;
				 var option = document.createElement("option");
				    option.text = "--";
				    option.value = "--";
				 try {
				        combo.add(option, null); //Standard
				    }catch(error) {
				        combo.add(option); // IE only
				    }
					for(var i=0; i<data.query.results.option.length; i++)
					{
						var contract = data.query.results.option[i].contract;
						//alert(contract);
						
					    option = document.createElement("option");
					    option.text = contract;
					    option.value = contract;
					    try {
					        combo.add(option, null); //Standard
					    }catch(error) {
					        combo.add(option); // IE only
					    }
					    
					    
								
					}
					 if(document.getElementById("expId").style.display=="none"){
						   document.getElementById("expId").style.display="";
					 }
					 Change_Cursor('none');
			};
			 
			// Instantiate with the query:
			var ajaxianPosts = new YQLQuery(optionsquery, callback);
			 
			// If you're ready then go:
			ajaxianPosts.fetch(); // Go!!
	}
	
	function deleteTable() {
		$('#POITable tr:gt(1)').remove()
	}
	   
	function queryYQL2()
	{
		//Construct your query:
		
	    var x =  1;
		var size = document.getElementById('POITable').rows.length - 1;

		if(size > 1)
		{
			deleteTable();
		}
		
		//var e1 = document.getElementById("type_"+x);
		//var strUser1 = e1.options[e1.selectedIndex].value;
		var expiration = "expiration_1";
	
	//var optionsquery = "SELECT * FROM yahoo.finance.options WHERE symbol='"+document.getElementById('ticker').value+"' AND expiration='"+document.getElementById('expiration_1').value + "' AND option.type='"+strUser1+"'";
	var optionsquery = "SELECT * FROM yahoo.finance.options WHERE symbol='"+document.getElementById('ticker').value+"' AND expiration='"+document.getElementById(expiration).value + "'";
	//alert("callback");
	// Define your callback:
			var callback = function(data) {
			  
				 if(document.getElementById("POITable").style.display=="none"){
					   document.getElementById("POITable").style.display="";
				 }
				 
				 document.getElementById("addrw").style.display="";
				  
				 document.getElementById("cmptable").style.display="";
					  
				 document.getElementById("subbtn").style.display="";
				 
				 document.getElementById("positiondiv").style.display="";
					  
				
				 var combo = document.getElementById("strike_"+x);
				 var combo1 = document.getElementById("strike_"+x+"c");
				 combo.options.length=0;
				 combo1.options.length=0;
				  var option = document.createElement("option");
				    option.text = "--";
				    option.value = "--";
				    try {
				        combo.add(option, null); //Standard
				        if(combo1 !=null)
				        	{
				        	var option1 = document.createElement("option");
						    option1.text = "--";
						    option1.value = "--";
				        	  combo1.add(option1, null); //Standard
						      	
				        	}
				    }catch(error) {
				        combo.add(option); // IE only
				        if(combo1 !=null)
			        	{
				        combo1.add(option); 
			        	}
					      
				    }
				 //alert(data.query.results.optionsChain.option.length);
					for(var i=0; i<data.query.results.optionsChain.option.length; i++)
					{
					
							var strike = data.query.results.optionsChain.option[i].strikePrice;
							//alert(contract);
							
						     option = document.createElement("option");
						    option.text = strike;
						    option.value = strike;
						    
						    try {
						        combo.add(option, null); //Standard
						        if(combo1 !=null)
						        	{
						        	var option1 = document.createElement("option");
								    option1.text = strike;
								    option1.value = strike;
						        	  combo1.add(option1, null); //Standard
								      	
						        	}
						    }catch(error) {
						        combo.add(option); // IE only
						        if(combo1 !=null)
					        	{
						        combo1.add(option); 
					        	}
							      
						    }
							combo.options[0].selected=true;
							if(combo1 !=null)
				        	{
								combo1.options[0].selected=true;
								
				        	}
							document.getElementById('premium_'+x).value='';
							/*
							if(size > 1)
								{
							for(var g=2;g<x;g++)
							{
								RemoveItems(document.getElementById("strike_"+g));
								CopyItem(combo,document.getElementById("strike_"+g))
								//document.getElementById("strike_"+g) = combo.cloneNode(true);	
								document.getElementById("strike_"+g).options[0].selected=true;
							}
								}
							*/
							Change_Cursor('none');
					}
					
			};
			 
			// Instantiate with the query:
			var ajaxianPosts = new YQLQuery(optionsquery, callback);
			 
			// If you're ready then go:
			ajaxianPosts.fetch(); // Go!!
	}
	
	
	
	function queryYQL3(obj)
	{
		// var x = document.getElementById('POITable').rows.length - 1;
		
			var par = obj.parentNode;
			while(par.nodeName.toLowerCase()!='tr'){ 
				par=par.parentNode; 
				} 
			x=par.rowIndex;
			var nodes = par.getElementsByTagName("td");
	
		//var e = document.getElementById("strike_"+x);
	
		var e = nodes[3].childNodes[0];
		var strUser = e.options[e.selectedIndex].value;
		//var e1 = document.getElementById("type_"+x);
		var e1 = nodes[2].childNodes[0];
		var strUser1 = e1.options[e1.selectedIndex].value;
		//var buy = document.getElementById("longshort_"+x).value;
		var buy = nodes[0].childNodes[0];
		if(strUser == "--" || strUser1 == "--" || buy == "--")
		{
			Change_Cursor('none');
			return;	
		}
		//Construct your query:
	//var optionsquery = "SELECT * FROM yahoo.finance.options WHERE symbol='"+document.getElementById('ticker').value+"' AND expiration='"+document.getElementById('expiration_1').value + "' AND " + " option.type='"+strUser1+"'";
	var optionsquery = "SELECT * FROM yahoo.finance.options WHERE symbol='"+document.getElementById('ticker').value+"' AND expiration='"+document.getElementById('expiration_1').value + "'";

		// Define your callback:
			var callback = function(data) {
			   if(data.query.results == null)
				   {
				     // randomly yql returns null or invalid, in this case ignore and do not populate premium
				   nodes[5].childNodes[0].value='';
				   Change_Cursor('none');
				   return;
				   }
				var len = data.query.results.optionsChain.option.length;
				
				for(var i=0;i<len;i++)
				{
					var strike = data.query.results.optionsChain.option[i].strikePrice;	
					if(strUser1==data.query.results.optionsChain.option[i].type)
					{
						if(strike == strUser)
						{
						
							if(data.query.results.optionsChain.option[i].bid == "" || data.query.results.optionsChain.option[i].ask == "" || data.query.results.optionsChain.option[i].bid == "NaN" || data.query.results.optionsChain.option[i].ask == "NaN")
							{
								//document.getElementById('premium_'+x).value = data.query.results.optionsChain.option[i].lastPrice;
								nodes[5].childNodes[0].value = data.query.results.optionsChain.option[i].lastPrice;
							}
							else if (data.query.results.optionsChain.option[i].bid == "" || data.query.results.optionsChain.option[i].bid == "NaN")
								{
								nodes[5].childNodes[0].value  = data.query.results.optionsChain.option[i].ask;
								}
							else
								{
								nodes[5].childNodes[0].value  = data.query.results.optionsChain.option[i].bid;
								}
							break;
						}
					}
				}
				Change_Cursor('none');
				
			};
			 
			// Instantiate with the query:
			var ajaxianPosts = new YQLQuery(optionsquery, callback);
			 
			// If you're ready then go:
			ajaxianPosts.fetch(); // Go!!
			 
			
	}
	
	
	function queryYQL31(obj)
	{
		// var x = document.getElementById('POITable').rows.length - 1;
		
			var par = obj.parentNode;
			while(par.nodeName.toLowerCase()!='tr'){ 
				par=par.parentNode; 
				} 
			x=par.rowIndex;
			var nodes = par.getElementsByTagName("td");
			
		x=x+1;
		var e = document.getElementById("strike_"+x+"c");
		var strUser = e.options[e.selectedIndex].value;
		var e1 = document.getElementById("type_"+x+"c");
		var strUser1 = e1.options[e1.selectedIndex].value;
		var buy = document.getElementById("longshort_"+x+"c").value;
		
		if(strUser == "--" || strUser1 == "--" || buy == "--")
		{
			return;	
		}
		//Construct your query:
	//var optionsquery = "SELECT * FROM yahoo.finance.options WHERE symbol='"+document.getElementById('ticker').value+"' AND expiration='"+document.getElementById('expiration_1').value + "' AND " + " option.type='"+strUser1+"'";
	var optionsquery = "SELECT * FROM yahoo.finance.options WHERE symbol='"+document.getElementById('ticker').value+"' AND expiration='"+document.getElementById('expiration_1').value + "'";

		// Define your callback:
			var callback = function(data) {
				var len = data.query.results.optionsChain.option.length;
				
				for(var i=0;i<len;i++)
				{
					var strike = data.query.results.optionsChain.option[i].strikePrice;	
					if(strUser1==data.query.results.optionsChain.option[i].type)
					{
						if(strike == strUser)
						{
						
							document.getElementById('premium_'+x+"c").value = data.query.results.optionsChain.option[i].lastPrice;
							break;
						}
					}
				}
				Change_Cursor('none');
				
			};
			 
			// Instantiate with the query:
			var ajaxianPosts = new YQLQuery(optionsquery, callback);
			 
			// If you're ready then go:
			ajaxianPosts.fetch(); // Go!!
			 
			
	}
	

	   function CopyItem(firstListBox, secondListBox ) {
        for (var i = 0; i < firstListBox.options.length; i++) {
                var newOption = document.createElement("option");
                newOption.text = firstListBox.options[i].text;
                newOption.value = firstListBox.options[i].value;
                secondListBox.options[secondListBox.options.length] = newOption;
        }
        return false;
    }
	
	   
	   function RemoveItems(s) {
		    for (i = s.options.length - 1; i >= 0; i--) {
		            s.remove(i);
		    }
		    return false;
		}
	   
	   
	   function setTable(){
		   if(document.getElementById("POITable1").style.display=="none"){
		   document.getElementById("POITable1").style.display="";
		   document.getElementById("POITable1").align="center";
		   document.getElementById('cmpre').innerHTML="<input type='checkbox' name='compare' id='compare' value='compare' onclick='setTable()'>Click to Remove Comparson</label>";
			 
		   
		   document.getElementById('POITable1Count').value="1";
			
		   }
		   else if(document.getElementById("POITable1").style.display==""){
		   document.getElementById("POITable1").style.display="none";
		   document.getElementById('cmpre').innerHTML="<input type='checkbox' name='compare' id='compare' value='compare' onclick='setTable()'>Click Here to add and compare positions</label>";
		   document.getElementById('POITable1Count').value="0";
		 	
		   }
		   if(document.getElementById("POITable1Add").style.display=="none"){
			   document.getElementById("POITable1Add").style.display="";
			   }
			   else if(document.getElementById("POITable1Add").style.display==""){
			   document.getElementById("POITable1Add").style.display="none";
			   //also submit form
				document.optionform.submit();
			   }
		   }
	   
	   function loadAllValues()
	   {
	
		 
		  var exp =  document.getElementById("expiration_1");
		  %{
		  if(params.get('expiration_1')  == null)
		  {
		%}
		  
			   return;
			 %{
		  }
			 %}
		  
		  document.getElementById("expId").style.display="";
			
		   document.getElementById("POITable").style.display="";
		  
		   document.getElementById("addrw").style.display="";
			  
		   document.getElementById("cmptable").style.display="";
			  
		   document.getElementById("subbtn").style.display="";
		   
		   document.getElementById("positiondiv").style.display="";
			  
		
		  var option = document.createElement("option");
		    option.text = "${params.get('expiration_1')}";
		    option.value = "${params.get('expiration_1')}";
		    if(exp == null)
		    	{
		    	  return;
		    	}
		    try {
		    	exp.add(option, null); //Standard
		      
		    }catch(error) {
		    	exp.add(option); // IE only
		    }

			exp.options[1].selected=true;  
		    %{
		    	int indexcounts =0;
		    	int indexcomparecount = 0;
			if(params.get("POITableCount") != null)
				{
			 indexcounts = Integer.parseInt(params.get("POITableCount"));
				}
			 if(params.get("POITable1Count") !=null && !params.get("POITable1Count").equals(""))
				 {
				 System.out.println("params is "+params.get("POITable1Count"));
			 indexcomparecount = Integer.parseInt(params.get("POITable1Count"));
				 }
			%}
			
			document.getElementById("POITableCount").value="${indexcounts}";
			
			document.getElementById("POITable1Count").value="${indexcomparecount}";
			
			  
			//ok so now we know that we have 3 counts with 1 and 1c mandatory
			
			%{
				for(int i = 1;i<=indexcounts;i++)
					{
			%}
				%{
					if(i < indexcounts)
						{
						%}
						document.getElementById("addmorePOIbutton").onclick();
						%{ 
				   }
				%}
			var buysell =  document.getElementById("longshort_"+${i});
			   option = document.createElement("option");
			    option.text = "${params.get('longshort_'+i)}";
			    option.value = "${params.get('longshort_'+i)}";
			    
			    try {
			    	buysell.add(option, null); //Standard
			      
			    }catch(error) {
			    	buysell.add(option); // IE only
			    }

			    if(option.value == "BUY")
			    	{
			    	 buysell.options[1].selected=true;
					    	
			    	}
			    else if(option.value == "SELL")
			    	{
			   	 buysell.options[2].selected=true;
						
			    	}
			    
			   var contracts = document.getElementById("contracts_"+${i});
				contracts.value="${params.get('contracts_'+i)}";
			    
			    var type =  document.getElementById("type_"+${i});
				   option = document.createElement("option");
				    option.text = "${params.get('type_'+i)}";
				    option.value = "${params.get('type_'+i)}";
				    
				    try {
				    	type.add(option, null); //Standard
				      
				    }catch(error) {
				    	type.add(option); // IE only
				    }

				    if(option.value == "C")
			    	{
			    	 type.options[1].selected=true;
					    	
			    	}
			    else if(option.value == "P")
			    	{
			   	 type.options[2].selected=true;
						
			    	}
				    
				    var strike =  document.getElementById("strike_"+${i});
					   option = document.createElement("option");
					    option.text = "${params.get('strike_'+i)}";
					    option.value = "${params.get('strike_'+i)}";
					    
					    try {
					    	strike.add(option, null); //Standard
					      
					    }catch(error) {
					    	strike.add(option); // IE only
					    }

					    for(var i = 0; i < strike.options.length; ++i)
					    	{
					    	  if(strike.options[i].value == option.value)
					    		  {
					    		  strike.options[i].selected=true;
					    		  }
					    	}
				            
					    
					    
					    var premium = document.getElementById("premium_"+${i});
					    
					    premium.value="${params.get('premium_'+i)}";
						
					    
					    %{
					    }
						%}
			    

			%{
				for(int i = 1;i<=indexcomparecount;i++)
					{
			%}
				%{
					if(i < indexcomparecount)
						{
						%}
						document.getElementById("addmorePOIbuttonCompare").onclick();
						%{ 
				   }
				%}
				%{ if(i == 1) {
				%}
				  setTable();
				%{
				}
				%}
			var buysell =  document.getElementById("longshort_"+${i}+"c");
			   option = document.createElement("option");
			    option.text = "${params.get('longshort_'+i+'c')}";
			    option.value = "${params.get('longshort_'+i+'c')}";
			    
			    try {
			    	buysell.add(option, null); //Standard
			      
			    }catch(error) {
			    	buysell.add(option); // IE only
			    }

			    if(option.value == "BUY")
		    	{
		    	 buysell.options[1].selected=true;
				    	
		    	}
		    else if(option.value == "SELL")
		    	{
		   	 buysell.options[2].selected=true;
					
		    	}
			    
			    var contracts = document.getElementById("contracts_"+${i}+"c");
				contracts.value="${params.get('contracts_'+i+'c')}";
			    
			    
			    
			    var type =  document.getElementById("type_"+${i}+"c");
				   option = document.createElement("option");
				    option.text = "${params.get('type_'+i+'c')}";
				    option.value = "${params.get('type_'+i+'c')}";
				    
				    try {
				    	type.add(option, null); //Standard
				      
				    }catch(error) {
				    	type.add(option); // IE only
				    }

				    if(option.value == "C")
			    	{
			    	 type.options[1].selected=true;
					    	
			    	}
			    else if(option.value == "P")
			    	{
			   	 type.options[2].selected=true;
						
			    	}
				    
				    var strike =  document.getElementById("strike_"+${i}+"c");
					   option = document.createElement("option");
					    option.text = "${params.get('strike_'+i+'c')}";
					    option.value = "${params.get('strike_'+i+'c')}";
					    
					    try {
					    	strike.add(option, null); //Standard
					      
					    }catch(error) {
					    	strike.add(option); // IE only
					    }

					    strike.options[1].selected=true;
					    
   						var premium = document.getElementById("premium_"+${i}+"c");
					    
					    premium.value="${params.get('premium_'+i+'c')}";
						var compare = document.getElementById("compare");
						compare.value="compare";
					    compare.checked=true;
					    %{
					    }
						%}

			   document.optionform.submit();
				 
			
		 }
	   
	   function Change_Cursor(mark)
	   {
		    document.getElementById("throbber").style.display=mark;
	   }
	   

	   $(function() {
		   
		    $("form").bind("keypress", function(e) {
		            if (e.keyCode == 13) return false;
		      });
		 
		});

	 
	</script>
	

<div class="throbber" style="display:none" id="throbber"></div>
	
<div  align="center"><h2>Strategy Builder</h2></div>
    <div class="container">
    <body onload="loadAllValues()">
<form class="form-inline" name="optionform" action="@{Application.sayHello()}"  target="my_iframe" method="GET">
<br/>
Welcome ${username}
  <div id="POItablediv" align="center">
  <div class="row">
  <div class="span4 offset4" align="center">
   <br>
        <b>Ticker :</b> <input type="text" size="5" class="span1" name="ticker" id="ticker" value="${params.get('ticker')}" > 
  	<input type="button"  onclick="Change_Cursor('');queryYQL();queryYQL1(); " value="Go" id="gobutton" class="btn-mini btn-primary">
  	
  	</div>
  	</div>
  	<br/>
  	<div class="row">
  	<div class="span4 offset4">
  		<table style="display:none" id="expId"  cellpadding="3px" border="0">
  		<tbody>
  		<tr>
<td nowrap><label class="control-label"><b>Stock Price :</b></label></td>

  			<td><input type="text" id="stockPrice"  readonly value="${params.get('stockPrice')}" name="stockPrice" class="span1" size="10"> </td>
  			<td valign="center"><img src="@{'/public/images/refresh.gif'}" alt="Refresh" height="15" width="10" onclick="Change_Cursor('');queryYQL()"/></td>
<td><img src="@{'/public/images/clear.gif'}"   width="30"></td>
	<td align="center" nowrap ><label class="control-label"><b>Expiration :</b></label></td>
  			<td><select class="span2" name="expiration_1" id="expiration_1"  onchange="Change_Cursor('');queryYQL2();"><option>--</option></select></td>
  			<td valign="center"><img src="@{'/public/images/refresh.gif'}" alt="Refresh" height="15" width="10" onclick="Change_Cursor('');queryYQL1()"/></td>
       </tr>
  		
       </tbody>
  	</table>
  	</div>
  	 </div>
  	 <br/>
  	 <div class="row">
  	<div class="span3 offset3" align="center">
    <table id="POITable" style="display:none"   border="0">
    	<thead>
        <tr>
        	<th><label class="control-label"><b>Buy/Sell</b></label></th>
            <th><label class="control-label"><b>Contracts</b></label></th>
            <th><label class="control-label"><b>Type</b></label></th>
            <th colspan="2"><label class="control-label"><b>Strike</b></label></th>
        	<th colspan="2"><label class="control-label"><b>Premium</b></label></th>
        </tr>
        </thead>
        <tbody>
        <tr>
        	<td><select class="span2" id="longshort_1" name="longshort_1" "><option value="--">--</option><option value="BUY">Buy</option><option value="SELL">Sell</option></select></td>
            <td><input size=5  class="span1" type="text" name="contracts_1" id="contracts_1" /></td>
            <td><select class="span2" id="type_1" name="type_1" onchange="Change_Cursor('');queryYQL3(this)"><option value="--" >--</option><option value="C">CALL</option><option value="P">PUT</option></select></td>
	        <td><select class="span2" name="strike_1" id="strike_1"  onchange="Change_Cursor('');queryYQL3(this)"><option value="--">--</option></select></td>
	        <td valign="top"><img src="@{'/public/images/refresh.gif'}" alt="Refresh" height="15" width="10" onclick="Change_Cursor('');queryYQL2()"/> </td>
            <td><input class="span1" size=10 type="text" name="premium_1" id="premium_1" /></td>
		    <td valign="top"><img src="@{'/public/images/refresh.gif'}" alt="Refresh" height="15" width="10" onclick="Change_Cursor('');queryYQL3(this)"/></td>
        	
            <td><input type="button" class="btn-mini btn-danger" id="delPOIbutton" value="Delete" onclick="deleteRow(this)"/></td>
           
        </tr>
        
         </tbody>
    </table>
    </div>
     </div>
      <div class="row">
    <table id="addrw" style="display:none" >
     <tr>
      		 <td>
      		 <input class="btn-mini btn-primary" type="button" id="addmorePOIbutton" value="Add" onclick="insRow()" style="margin-left: 450px;"/>
      		 </td>
        </tr>
    
    </table>
    </div>
     <div class="row">
     <table id ="cmptable" style="display:none" >
     <tr>
    
       <td>
       <label class="checkbox" for="mylabel" id="cmpre">
       <input type="checkbox" name="compare" id="compare" value="compare" onclick="setTable()"> Click Here to add and compare positions </label>
       </td>
     </tr>
    
    </table>
    </div>
    <div class="row">
    <div class="span3 offset3" align="center">
     <table id="POITable1" border="0" style="display:none">
    	<tbody>
       
        <tr>
        	<td><select class="span2"id="longshort_1c" name="longshort_1c"><option value="--">--</option><option value="BUY">Buy</option><option value="SELL">Sell</option></select></td>
            <td><input class="span1" size=5 type="text" name="contracts_1c" id="contracts_1c" /></td>
            <td><select class="span2" id="type_1c" name="type_1c" onchange="Change_Cursor('');queryYQL31(this)"><option value="--" >--</option><option value="C">CALL</option><option value="P">PUT</option></select></td>
	        <td><select class="span2" name="strike_1c" id="strike_1c"  onchange="Change_Cursor('');queryYQL31(this)"><option value="--">--</option></select></td>
            <td><input size=10 class="span1" type="text" name="premium_1c" id="premium_1c" /></td>
        	<td valign="top"><img src="@{'/public/images/refresh.gif'}" alt="Refresh" height="15" width="10" onclick="Change_Cursor('');queryYQL31(this)"/></td>
            <td><input type="button" class="btn-mini btn-danger" id="delPOIbutton" value="Delete" onclick="deleteRowCompare(this)"/></td>
           
        </tr>
        
         </tbody>
    </table>
    </div>
    </div>
     <div class="row">
     <table id ="POITable1Add" style="display:none">
     <tr>
      		 <td><input type="button" class="btn-mini btn-primary" id="addmorePOIbuttonCompare" value="Add" onclick="insRowCompare()" style="margin-left: 450px;"/></td>
        </tr>
    
    </table>
    </div>
   
     <button style="display:none" id="subbtn" type="submit" class="btn btn-primary">Submit</button>
     <br/>
     <br/>
     <a href="login">Login </a>  to Save position
     <div id="positiondiv" style="display:none"">
      <b>UserName :</b> <input type="text" size="5" class="span1" name="username" id="username" value="${params.get('username')}" >
      <b>PositionName :</b> <input type="text" size="15" class="span1" name="posname" id="posname" value="${params.get('posname')}" >
       
  	<button   type="submit" id="savebutton" class="btn-mini btn-primary">Add to porfolio</button>
  	
     </div>
     <input type="hidden" id="POITableCount" name="POITableCount" value="1"/>
     <input type="hidden" id="POITable1Count" name="POITable1Count" value="0"/>
     
  </div>
   
</form>
</body>

<script type='text/javascript'>//<![CDATA[ 


function deleteRow(row)
{
    var i=row.parentNode.parentNode.rowIndex;
    document.getElementById('POITable').deleteRow(i);
}

function deleteRowCompare(row)
{
    var i=row.parentNode.parentNode.rowIndex;
    document.getElementById('POITable1').deleteRow(i);
}


function deleteRowAtIndex(rownum)
{

    document.getElementById('POITable').deleteRow(rownum);
}

var rowcounter = 1;
function insRow()
{
//rowcounter has previous row
   
    var x=document.getElementById('POITable').getElementsByTagName('tbody')[0];
    var new_row = x.rows[x.rows.length-1].cloneNode(true);
	rowcounter=rowcounter+1;
	
   // var len = x.rows.length+1;
    var len = rowcounter;
    var inp1 = new_row.cells[0].getElementsByTagName('select')[0];
    inp1.id = inp1.id.split("_")[0] + "_" + len;
    inp1.name = inp1.name.split("_")[0]+ "_"+len;
    inp1.selectedIndex=x.rows[x.rows.length-1].cells[0].getElementsByTagName('select')[0].selectedIndex;
    //inp1.value = '';
    var inp2 = new_row.cells[1].getElementsByTagName('input')[0];
    inp2.id = inp2.id.split("_")[0] + "_"+ len;
    inp2.name = inp2.name.split("_")[0]+ "_"+len;
    inp2.value=x.rows[x.rows.length-1].cells[1].getElementsByTagName('input')[0].value;
    
   // inp2.value = '';
    var inp3 = new_row.cells[2].getElementsByTagName('select')[0];
    inp3.id = inp3.id.split("_")[0] + "_"+ len;
    inp3.name = inp3.name.split("_")[0]+ "_"+len;
    inp3.selectedIndex=x.rows[x.rows.length-1].cells[2].getElementsByTagName('select')[0].selectedIndex;
    
    var inp4 = new_row.cells[3].getElementsByTagName('select')[0];
    inp4.id = inp4.id.split("_")[0] + "_"+ len;
    inp4.name = inp4.name.split("_")[0]+ "_"+len;
    inp4.selectedIndex=x.rows[x.rows.length-1].cells[3].getElementsByTagName('select')[0].selectedIndex;
    
    var inp6 = new_row.cells[5].getElementsByTagName('input')[0];
    inp6.id = inp6.id.split("_")[0] + "_"+ len;
    inp6.name = inp6.name.split("_")[0]+ "_"+len;
    inp6.value=x.rows[x.rows.length-1].cells[5].getElementsByTagName('input')[0].value;;
    
    x.appendChild( new_row );
    
    document.getElementById('POITableCount').value=len;
    
}

var rowcountcmp=1;
function insRowCompare()
{
	 var x=document.getElementById('POITable1').getElementsByTagName('tbody')[0];
	    var new_row = x.rows[x.rows.length-1].cloneNode(true);
		rowcounter=rowcounter+1;
		
	   // var len = x.rows.length+1;
	    var len = rowcountcmp;
    var inp1 = new_row.cells[0].getElementsByTagName('select')[0];
    inp1.id = inp1.id.split("_")[0] + "_" + len+"c";
    inp1.name = inp1.name.split("_")[0]+ "_"+len+"c";
    inp1.selectedIndex=x.rows[x.rows.length-1].cells[0].getElementsByTagName('select')[0].selectedIndex;
    
    //inp1.value = '';
    var inp2 = new_row.cells[1].getElementsByTagName('input')[0];
    inp2.id = inp2.id.split("_")[0] + "_"+ len+"c";
    inp2.name = inp2.name.split("_")[0]+ "_"+len+"c";
    inp2.value=x.rows[x.rows.length-1].cells[1].getElementsByTagName('input')[0].value;
    
   
   // inp2.value = '';
    var inp3 = new_row.cells[2].getElementsByTagName('select')[0];
    inp3.id = inp3.id.split("_")[0] + "_"+ len+"c";
    inp3.name = inp3.name.split("_")[0]+ "_"+len+"c";
    inp3.selectedIndex=x.rows[x.rows.length-1].cells[2].getElementsByTagName('select')[0].selectedIndex;
    
   
    var inp4 = new_row.cells[3].getElementsByTagName('select')[0];
    inp4.id = inp4.id.split("_")[0] + "_"+ len+"c";
    inp4.name = inp4.name.split("_")[0]+ "_"+len+"c";
    inp4.selectedIndex=x.rows[x.rows.length-1].cells[3].getElementsByTagName('select')[0].selectedIndex;
    
   
    var inp6 = new_row.cells[4].getElementsByTagName('input')[0];
    inp6.id = inp6.id.split("_")[0] + "_"+ len+"c";
    inp6.name = inp6.name.split("_")[0]+ "_"+len+"c";
    inp6.value=x.rows[x.rows.length-1].cells[4].getElementsByTagName('input')[0].value;;
    
    
    x.appendChild( new_row );
    
    document.getElementById('POITable1Count').value=len;
    
}
//]]>  

</script>
<div align="center">
<iframe name="my_iframe" width="800"  height="600" frameborder="0"></iframe>
</div>
     
   <div class="subnav">
    <ul class="nav nav-pills">
      <li><a href="#labels">Home</a></li>
      <li><a href="#badges">Software</a></li>
      <li><a href="#typography">Contact Us</a></li>
      <li><a href="#thumbnails">About</a></li>
    </ul>
  </div>
    

    </div> <!-- /container -->
     <script type="text/javascript">
    
</script>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="@{'/public/javascripts/jquery-1.7.1.js'}"></script>
    <script src="@{'/public/javascripts/bootstrap.js'}"></script>
    <script src="@{'/public/javascripts/bootstrap.min.js'}"></script>
     <script src="@{'/public/javascripts/bootstrap-dropdown.js'}"></script>
       <script src="@{'/public/javascripts/bootstrap-transition.js'}"></script>
     
     
<script src="@{'/public/javascripts/bootstrap-collapse.js'}"></script>



